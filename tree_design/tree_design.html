<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í¬ë¦¬ìŠ¤ë§ˆìŠ¤ íŠ¸ë¦¬ ê¾¸ë¯¸ê¸°</title>
    <!--    external css-->
    <link rel="stylesheet" href="../css/tree_design.css">
</head>
<body>
    <h1>ğŸ„ íŠ¸ë¦¬ ê¾¸ë¯¸ê¸° ğŸ„</h1>
    <h4>ì˜¤ë„ˆë¨¼íŠ¸ë¥¼ í´ë¦­í•˜ì‹ í›„ ë“œë˜ê·¸ í•´ì£¼ì„¸ìš”!</h4>

    <div id="particles-js"></div>

    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <script>
        particlesJS("particles-js", {
            "particles": {
                "number": {
                    "value": 250, // ëˆˆì†¡ì´ ê°œìˆ˜
                    "density": {
                        "enable": true,
                        "value_area": 800
                    }
                },
                "color": {
                    "value": "#ffdddd" // ëˆˆì†¡ì´ ìƒ‰ìƒ (í°ìƒ‰)
                },
                "shape": {
                    "type": "circle", // ëˆˆì†¡ì´ ëª¨ì–‘
                    "stroke": {
                        "width": 0,
                        "color": "#000000"
                    }
                },
                "opacity": {
                    "value": 1.2,
                    "random": true
                },
                "size": {
                    "value": 5,
                    "random": true
                },
                "line_linked": {
                    "enable": false // ëˆˆì†¡ì´ë¼ë¦¬ ì„ ì„ ê·¸ë¦¬ì§€ ì•ŠìŒ
                },
                "move": {
                    "enable": true,
                    "speed": 1.5, // ëˆˆì†¡ì´ ë–¨ì–´ì§€ëŠ” ì†ë„
                    "direction": "bottom", // ëˆˆì†¡ì´ ì´ë™ ë°©í–¥ (ì•„ë˜ë¡œ)
                    "random": false,
                    "straight": false,
                    "out_mode": "out",
                    "bounce": false
                }
            },
            "interactivity": {
                "detect_on": "canvas",
                "events": {
                    "onhover": {
                        "enable": false // ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë ¤ë„ ë°˜ì‘í•˜ì§€ ì•ŠìŒ
                    },
                    "onclick": {
                        "enable": false // í´ë¦­ ë°˜ì‘ ë¹„í™œì„±í™”
                    }
                }
            },
            "retina_detect": true
        });
    </script>

    <div class="palette">
        <img src="../img/green%20ball.png" alt="Green Ball" onmousedown="addOrnament('../img/green ball.png')">
        <img src="../img/red%20ball.png" alt="Red Ball" onclick="addOrnament('../img/red ball.png')">
        <img src="../img/striped%20ball.png" alt="Striped Ball" onclick="addOrnament('../img/striped ball.png')">
        <img src="../img/candycane.png" alt="Candy Cane" onclick="addOrnament('../img/candycane.png')">
        <img src="../img/stocking.png" alt="Stocking" onclick="addOrnament('../img/stocking.png')">
        <img src="../img/star.png" alt="Star" onclick="addOrnament('../img/star.png')">
        <img src="../img/lights.png" alt="Lights" onclick="addOrnament('../img/lights.png', true)">
    </div>

    <!-- Tree Container -->
    <div class="background" id="background"></div>

    <!-- Controls -->
    <div class="controls">
        <button onclick="resetTree()">ë¦¬ì…‹</button>
        <button onclick="saveTree()">ì´ë¯¸ì§€ ì €ì¥</button>
    </div>

    <script>
        const background = document.getElementById('background');

        // Add a new ornament to the tree
        function addOrnament(src, isLights = false) {
            const newOrnament = document.createElement('img');
            newOrnament.src = src;
            newOrnament.className = 'draggable';
            newOrnament.style.position = 'absolute';
            newOrnament.style.top = '400px'; // Default position
            newOrnament.style.left = '200px'; // Default position

            if (isLights) {
                newOrnament.style.width = '160px'; // Wider lights
                newOrnament.style.height = '100px'; // Height for lights
            } else {
                newOrnament.style.width = '40px';
                newOrnament.style.height = '40px';
            }

            background.appendChild(newOrnament);
            makeDraggable(newOrnament);
        }

        // Make an element draggable
        function makeDraggable(element) {
            element.style.cursor = 'grab';

            // let offsetX = element.clientX - element.parentElement.offsetLeft;
            // let offsetY = element.clientY - element.parentElement.offsetTop;
            // element.style.left = `${e.clientX - offsetX}px`;
            // element.style.top = `${e.clientY - offsetY}px`;

            element.addEventListener('mousedown', (e) => {
                e.preventDefault();
                let offsetX = e.clientX - element.offsetLeft;
                let offsetY = e.clientY - element.offsetTop;

                // ë“œë˜ê·¸ ì‹œì‘ ì‹œ ì»¤ì„œ ë³€ê²½
                element.style.cursor = 'grabbing';

                // let offsetX = e.clientX - element.getBoundingClientRect().left;
                // let offsetY = e.clientY - element.getBoundingClientRect().top;
                

                const onMouseMove = (e) => {
                    element.style.left = `${e.clientX - offsetX}px`;
                    element.style.top = `${e.clientY - offsetY}px`;
                };

                const onMouseUp = () => {
                    document.removeEventListener('mousemove', onMouseMove);
                    document.removeEventListener('mouseup', onMouseUp);
                    // ë“œë˜ê·¸ ëë‚œ í›„ ì»¤ì„œ ë³µì›
                    element.style.cursor = 'grab';
                };

                document.addEventListener('mousemove', onMouseMove);
                document.addEventListener('mouseup', onMouseUp);
            });
        }

        // Reset the tree by clearing all decorations
        function resetTree() {
            background.innerHTML = '';
        }

        // Save the tree as an image
        function saveTree() {
            html2canvas(background).then(canvas => {
                const link = document.createElement('a');
                link.download = '../img/decorated-tree.png';
                link.href = canvas.toDataURL('image/png');
                link.click();
            });
        }

        // Create falling particles
        function createParticles() {
            const particleCount = 50; // Number of particles
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = `${Math.random() * 100}vw`; // Random horizontal position
                particle.style.animationDuration = `${3 + Math.random() * 2}s`; // Random fall speed
                particle.style.animationDelay = `${Math.random() * 2}s`; // Random delay
                document.body.appendChild(particle);
            }
        }

        // Start the particle effect
        createParticles();
    </script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
   <a href="../index.html" class="back-button">ğŸ  ë©”ì¸ í˜ì´ì§€ë¡œ ëŒì•„ê°€ê¸°</a>
</body>
</html>
